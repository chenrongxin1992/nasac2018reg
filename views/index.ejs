<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>NASAC2018会议注册</title>
<link rel="stylesheet" href="/nasac2018reg/stylesheets/layui.css" media="all">
</head>
<body>
<div class="layui-container"> 
	<div class="layui-row">
		<div class="layui-col-12">
			<img class="img-responsive" src="/nasac2018reg/images/sz.jpg" alt="NASAC2018" style="width: 100%">
		</div>
	</div>
	<div class="layui-row">
		<div class="layui-col-12">
			<fieldset class="layui-elem-field layui-field-title" style="margin-top: 50px;">
			  <legend>NASAC2018会议注册</legend>
			</fieldset>
			<form class="layui-form layui-form-pane" action="">
			  <div class="layui-form-item">
			    <label class="layui-form-label">姓名</label>
			    <div class="layui-input-inline">
			      <input type="text" name="name" autocomplete="off" placeholder="请输入姓名" class="layui-input" lay-verify="required">
			    </div>
			    <label class="layui-form-label">单位/学校</label>
			    <div class="layui-input-inline">
			      <input type="text" name="company" autocomplete="off" placeholder="请输入单位" class="layui-input" lay-verify="required" > 
			    </div>
			    <label class="layui-form-label">手机号码</label>
		        <div class="layui-input-inline">
		         <input type="tel" name="phone" lay-verify="required|phone" placeholder="请输入手机号码" autocomplete="off" class="layui-input">
		        </div>
			  </div>
			  <div class="layui-form-item">
			    <label class="layui-form-label">注册类型</label>
			    <div class="layui-input-inline">
			      <select name="regtype" lay-filter="regtype" lay-verify="required">
			        <option value=""></option>
			        <option value="0">院士/特邀报告人</option>
			        <option value="1">专委委员</option>
			        <option value="2">CCF会员</option>
			        <option value="3">CCF学生会员</option>
			        <option value="4">学生</option>
			        <option value="5">其他</option>
			      </select>
			    </div>
			    <div class="layui-form-mid layui-word-aux" id="zcf" value=''></div>
			  </div>

			  <div class="layui-form-item" style="display: none;" id="ccfhy">
			    <label class="layui-form-label">会员号</label>
			    <div class="layui-input-inline">
			      <div class="layui-input-inline">
			        <input type="text" name="ccfhy" autocomplete="off" placeholder="请输入CCF会员号" class="layui-input">
			      </div>
			    </div>
			  </div>

			  <div class="layui-form-item" style="display: none;" id="ccfxshy">
			    <label class="layui-form-label">会员号</label>
			    <div class="layui-input-inline">
			      <div class="layui-input-inline">
			        <input type="text" name="ccfxshy" autocomplete="off" placeholder="请输入CCF学生会员号" class="layui-input" >
			      </div>
			    </div>
			  </div>

			  <div class="layui-form-item" style="display: none;" id="xuehao">
			    <label class="layui-form-label">学号</label>
			    <div class="layui-input-inline">
			      <div class="layui-input-inline">
			        <input type="text" name="xuehao" autocomplete="off" placeholder="请输入学号" class="layui-input" >
			      </div>
			    </div>
			  </div>

			  <div class="layui-form-item">
			    <div class="layui-input-block">
			      <button class="layui-btn" lay-submit="" lay-filter="demo1">确认注册</button>
			      <button type="reset" class="layui-btn layui-btn-primary">重置</button>
			    </div>
			  </div>
			</form>
		</div>
	</div>
</div>
<script src="/nasac2018reg/javascripts/layui.js"></script>
<script>
layui.use('form', function(){
  var form = layui.form;
  	  $ = layui.jquery 
  
  form.on('select(regtype)', function(data){
  	console.log('select --->',data)
  	if(data.value == 0){
  		$('#ccfhy').css('display','none')
  		$('#ccfxshy').css('display','none')
  		$('#xuehao').css('display','none')
  		$('#zcf').html('注册费 <span style="color:red;">0</span> 元').val(0)
  	}
  	if(data.value == 1){
  		$('#ccfhy').css('display','none')
  		$('#ccfxshy').css('display','none')
  		$('#xuehao').css('display','none')
  		$('#zcf').html('注册费 <span style="color:red;">1</span> 元').val(1)
  	}
  	if(data.value == 2){
  		console.log('CCF会员')
  		$('#ccfxshy').css('display','none')
  		$('#ccfhy').css('display','')
  		$('#xuehao').css('display','none')
  		$('#zcf').html('注册费 <span style="color:red;">2</span> 元').val(2)
  	}
  	if(data.value == 3){
  		console.log('CCF学生会员')
  		$('#zcf').html('注册费 <span style="color:red;">3</span> 元').val(3)
  		$('#ccfhy').css('display','none')
  		$('#xuehao').css('display','none')
  		$('#ccfxshy').css('display','')
  	}
  	if(data.value == 4){
  		console.log('学生')
  		$('#ccfhy').css('display','none')
  		$('#ccfxshy').css('display','none')
  		$('#xuehao').css('display','')
  		$('#zcf').html('注册费 <span style="color:red;">4</span> 元').val(4)
  	}
  	if(data.value == 5){
  		$('#ccfhy').css('display','none')
  		$('#ccfxshy').css('display','none')
  		$('#xuehao').css('display','none')
  		$('#zcf').html('注册费 <span style="color:red;">5</span> 元').val(5)
  	}
  })
  //监听提交
  form.on('submit(demo1)', function(data){
  	//if(data)
  	console.log(typeof(data.field.ccfhy))
  	console.log(data.field.regtype)
  	if(data.field.regtype == '2' && !data.field.ccfhy){
  		console.log('dd')
  		layer.msg('请输入CCF会员号!', {icon: 6, time: 1000});
  		return false
  	}
  	if(data.field.regtype == '3' && !data.field.ccfxshy){
  		layer.msg('请输入CCF学生会员号!', {icon: 6, time: 1000});
  		return false
  	}
  	if(data.field.regtype == '4' && !data.field.xuehao){
  		layer.msg('请输入学号!', {icon: 6, time: 1000});
  		return false
  	}
    
    $.ajax({
    	url:'/nasac2018reg/reg',
    	method:'POST',
    	data:{
    		name:data.field.name,
    		company:data.field.company,
    		phone:data.field.phone,
    		regtype:data.field.regtype,
    		regmoney:$('#zcf').val(),
    		ccfhy:data.field.ccfhy,
    		ccfxshy:data.field.ccfxshy,
    		xuehao:data.field.xuehao
    	},
    	success:function(result){
    		layer.alert('注册成功，点击确定返回。', {
				closeBtn: false    // 是否显示关闭按钮
			    ,anim: 1 //动画类型
			    ,btn: ['确定'] //按钮
			    ,icon: 6    // icon
			    ,yes:function(){
			        window.location.href="http://nasac2018.szu.edu.cn/?zwtz=zhuce";
  					window.close();
			    }
			    });

    	},
    	error:function(err){
    		console.log(err)
    	}
    })
    return false;
  });
  //各种基于事件的操作，下面会有进一步介绍
});
</script>